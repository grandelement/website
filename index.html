<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GE Universe – stable baseline</title>
<style>
  html,body{margin:0;height:100%;overflow:hidden;background:#000;color:#eaf2ff;font:14px/1.4 system-ui,Segoe UI,Roboto,Arial,sans-serif}
  #bg,#fx,#rp{position:fixed;inset:0}
  #fx{z-index:2} #rp{z-index:3;pointer-events:none}

  /* Sun + moon */
  #sunWrap{position:fixed;left:16vw;top:66vh;transform:translate(-50%,-50%);width:280px;height:280px;z-index:5}
  .sun{position:absolute;inset:0;border-radius:50%;background:center/cover no-repeat url("images/ge-logo-2.jpg");
       box-shadow:inset 0 0 60px rgba(255,255,255,.12)}
  .sunOverlay{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;pointer-events:none}
  .about{pointer-events:auto;margin-top:10%;font-weight:900;letter-spacing:.22em;font-size:13px;text-shadow:0 0 14px rgba(150,190,255,.55);cursor:pointer}
  .musicBtn{pointer-events:auto;margin-top:auto;margin-bottom:12%;font-weight:800;border:1px solid rgba(220,240,255,.35);
            background:rgba(12,24,40,.6);padding:6px 10px;border-radius:999px;cursor:pointer}
  .orbit{position:absolute;inset:0;transform-origin:50% 50%}
  .carrier{position:absolute;left:50%;top:50%}
  .moon{position:absolute;left:0;top:0;transform:translate(200px,-50%);width:110px;height:110px;border-radius:50%;cursor:pointer;
        background:radial-gradient(circle, rgba(160,210,255,.55) 0%, rgba(160,210,255,.25) 60%, rgba(160,210,255,0) 70%),
                   center/cover no-repeat url("images/ge-radio-logo.png");
        box-shadow:0 0 10px 4px rgba(140,200,255,.35);border:1px solid rgba(160,210,255,.55)}
  /* tiny toast */
  #toast{position:fixed;left:10px;bottom:10px;background:rgba(10,18,30,.9);border:1px solid rgba(200,220,255,.35);
         border-radius:999px;padding:6px 10px;font-size:12px;opacity:.85;z-index:99}
</style>
</head>
<body>

<canvas id="bg"></canvas>
<canvas id="fx"></canvas>
<canvas id="rp"></canvas>

<div id="sunWrap">
  <div class="sun">
    <div class="sunOverlay">
      <div class="about" id="aboutBtn">ABOUT</div>
      <button class="musicBtn" id="musicBtn">Music</button>
    </div>
  </div>
  <div class="orbit"><div class="carrier"><div class="moon" id="moon" title="GE RADIO"></div></div></div>
</div>

<div id="toast">Ready.</div>

<script>
/* ----------------------- canvases & resize ----------------------- */
const C = {
  bg: document.getElementById('bg'),
  fx: document.getElementById('fx'),
  rp: document.getElementById('rp')
};
const CTX = { bg: C.bg.getContext('2d'), fx: C.fx.getContext('2d'), rp: C.rp.getContext('2d') };
function fit(){ for(const k of Object.values(C)){ k.width=innerWidth; k.height=innerHeight; } }
addEventListener('resize', fit, {passive:true}); fit();

/* ----------------------- BACKGROUND MANAGER ----------------------- */
const BACKGROUNDS = [
  "images/stars backgrounds/Grand Element - Fundamental Groove.jpg",
  "images/stars backgrounds/Grand Element - Trio.jpg",
  "images/stars backgrounds/Grand Element - Live.jpg",
  "images/stars backgrounds/Grand Element - Sessions I.jpg",
  "images/stars backgrounds/Grand Element - Sessions II.jpg",
  "images/stars backgrounds/Grand Element - Intergy.jpg",
  "images/stars backgrounds/Grand Element - Love.jpg",
  "images/stars backgrounds/Grand Element - Soul.jpg",
  "images/stars backgrounds/Grand Element - Spirit.jpg",
  "images/stars backgrounds/Grand Element - Fire.jpg"
];
let bgIndex = 0;
function setBG(i){
  document.body.style.background = `#000 url("${BACKGROUNDS[i%BACKGROUNDS.length]}") center / cover no-repeat fixed`;
}
setBG(0);

/* ripple + advance background */
let teleportBusy = false;
function teleportFrom(x,y){
  if(teleportBusy) return; teleportBusy=true;
  const ctx=CTX.rp, start=performance.now(), dur=1200;
  function draw(now){
    const t=Math.min(1,(now-start)/dur);
    ctx.clearRect(0,0,innerWidth,innerHeight);
    ctx.save(); ctx.globalAlpha=0.35*(1-t);
    ctx.beginPath(); ctx.arc(x,y, Math.hypot(innerWidth,innerHeight)*t, 0, Math.PI*2);
    ctx.lineWidth=6*(1-t)+1; ctx.strokeStyle='rgba(120,180,255,0.85)'; ctx.stroke();
    ctx.restore();
    if(t<1) requestAnimationFrame(draw);
    else { ctx.clearRect(0,0,innerWidth,innerHeight); bgIndex=(bgIndex+1)%BACKGROUNDS.length; setBG(bgIndex); teleportBusy=false; }
  }
  requestAnimationFrame(draw);
}

/* ----------------------- STARS + SHIPS ----------------------- */
const STAR_COUNT=1000, LINK_RADIUS=28, MAX_LINKS=1, GRID=64;
const stars = Array.from({length:STAR_COUNT}, ()=>({x:Math.random()*innerWidth,y:Math.random()*innerHeight,vx:(Math.random()-.5)*0.05,vy:(Math.random()-.5)*0.05,r:Math.random()*1.1+0.2}));
const ships = Array.from({length:10}, ()=>({x:Math.random()*innerWidth,y:Math.random()*innerHeight,vx:(Math.random()-.5)*0.12,vy:(Math.random()-.5)*0.12,size:6}));
function gridBuild(){ const cols=Math.ceil(innerWidth/GRID), rows=Math.ceil(innerHeight/GRID), g=Array.from({length:cols*rows},()=>[]);
  for(let i=0;i<stars.length;i++){ const s=stars[i]; let cx=(s.x/GRID)|0, cy=(s.y/GRID)|0; cx=Math.max(0,Math.min(cols-1,cx)); cy=Math.max(0,Math.min(rows-1,cy)); g[cx+cy*cols].push(i); }
  return {g,cols,rows};
}
function starsLoop(){
  const ctx=CTX.bg;
  ctx.clearRect(0,0,innerWidth,innerHeight);
  // stars
  ctx.globalAlpha=0.9; ctx.fillStyle='#cfe9ff';
  ctx.beginPath();
  for(const s of stars){
    s.x+=s.vx; s.y+=s.vy;
    if(s.x<0)s.x+=innerWidth; if(s.x>innerWidth)s.x-=innerWidth; if(s.y<0)s.y+=innerHeight; if(s.y>innerHeight)s.y-=innerHeight;
    ctx.moveTo(s.x+s.r,s.y); ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
  }
  ctx.fill();
  // faint links
  const {g,cols,rows}=gridBuild(); ctx.globalAlpha=0.18; ctx.lineWidth=1; ctx.strokeStyle='#9ec8ff';
  for(let cx=0;cx<cols;cx++)for(let cy=0;cy<rows;cy++){
    const cell=g[cx+cy*cols]; if(!cell.length) continue;
    const neigh=[]; for(let dx=-1;dx<=1;dx++)for(let dy=-1;dy<=1;dy++){ const nx=cx+dx,ny=cy+dy; if(nx<0||ny<0||nx>=cols||ny>=rows) continue; neigh.push(...g[nx+ny*cols]); }
    for(const i of cell){
      const a=stars[i]; let links=0;
      for(const j of neigh){ if(i===j) continue; const b=stars[j]; const dx=a.x-b.x,dy=a.y-b.y;
        if(dx*dx+dy*dy<LINK_RADIUS*LINK_RADIUS){ ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);ctx.stroke(); if(++links>=MAX_LINKS) break; }
      }
    }
  }
  // ships
  ctx.globalAlpha=1;
  for(const sh of ships){
    sh.x+=sh.vx; sh.y+=sh.vy;
    if(sh.x<-20) sh.x=innerWidth+20; if(sh.x>innerWidth+20) sh.x=-20; if(sh.y<-20) sh.y=innerHeight+20; if(sh.y>innerHeight+20) sh.y=-20;
    ctx.beginPath(); ctx.arc(sh.x,sh.y,sh.size,0,Math.PI*2); ctx.fillStyle='#6fb8ff'; ctx.fill();
  }
  requestAnimationFrame(starsLoop);
}
starsLoop();

/* click near a ship → teleport */
C.fx.addEventListener('click', e=>{
  let best=null, bestD=24;
  for(const s of ships){ const d=Math.hypot(s.x-e.clientX,s.y-e.clientY); if(d<bestD){ best=s; bestD=d; } }
  if(best) teleportFrom(best.x,best.y);
});

/* ----------------------- SUN + MOON ----------------------- */
const wrap=document.getElementById('sunWrap');
const carrier=wrap.querySelector('.carrier');
const moon=document.getElementById('moon');
const ORBIT_SECONDS=60;
(function orbit(){
  const t=performance.now()/1000, ang=-2*Math.PI*(t/ORBIT_SECONDS);      // clockwise 60s
  carrier.style.transform=`rotate(${ang}rad)`;
  moon.style.transform=`translate(200px,-50%) rotate(${-ang}rad)`;       // keep moon upright
  requestAnimationFrame(orbit);
})();

/* drag the sun (avoid starting drag on the moon/buttons) */
let dragging=false,sx=0,sy=0,startL=0,startT=0;
wrap.addEventListener('pointerdown',e=>{
  if(e.target.id==='moon' || e.target.id==='aboutBtn' || e.target.id==='musicBtn') return;
  dragging=true; sx=e.clientX; sy=e.clientY;
  const r=wrap.getBoundingClientRect(); startL=r.left+r.width/2; startT=r.top+r.height/2;
  wrap.setPointerCapture(e.pointerId);
});
wrap.addEventListener('pointermove',e=>{
  if(!dragging) return;
  wrap.style.left = (startL + (e.clientX-sx))+'px';
  wrap.style.top  = (startT + (e.clientY-sy))+'px';
  wrap.style.transform='translate(-50%,-50%)';
});
wrap.addEventListener('pointerup',e=>{ dragging=false; try{ wrap.releasePointerCapture(e.pointerId);}catch(_){} });

/* buttons */
document.getElementById('aboutBtn').onclick=()=>window.open('https://grandelement.com/about','_blank','noopener');
moon.onclick=()=>window.open('https://grandelement.github.io/radio/','_blank','noopener');
document.getElementById('musicBtn').onclick=()=>show('Music panel coming next…');

/* helper toast */
function show(msg){ const t=document.getElementById('toast'); t.textContent=msg; clearTimeout(show._id); show._id=setTimeout(()=>t.textContent='Ready.',1800); }
</script>
</body>
</html>
