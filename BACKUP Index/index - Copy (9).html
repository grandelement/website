<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Grand Element — Modular Baseline</title>
<style>
  html,body{height:100%;margin:0;background:#000;color:#dff3ff;font:14px/1.45 system-ui,Segoe UI,Roboto,Arial,sans-serif}
  body{
    background:#000 url("./images/GE stars.jpg") center/cover no-repeat fixed; /* no stretching */
    overflow:hidden;
  }
  /* HUD */
  #hud{position:fixed;left:10px;top:10px;z-index:99999;background:rgba(12,20,35,.85);border:1px solid rgba(180,220,255,.35);border-radius:10px;padding:10px 12px;backdrop-filter:blur(4px)}
  #hud b{color:#fff}
  .ok{color:#66ff9b}.fail{color:#ff7da1}.muted{opacity:.75}
  .small{font-size:12px;color:#cfe9ff}
  #mods{padding-left:18px;margin:6px 0 0}
  /* layers/anchors expected by modules */
  #fx{position:fixed;inset:0;display:block;z-index:1}
  #phrases{position:fixed;inset:0;z-index:2;pointer-events:none}
  #planets{position:fixed;inset:0;z-index:4}
  #sunWrap{position:fixed;left:16vw;top:62vh;transform:translate(-50%,-50%);z-index:5;width:280px;height:280px}
  #sun{position:absolute;inset:0;border-radius:50%;background:center/cover no-repeat url("./images/ge-logo-2.jpg");box-shadow:inset 0 0 60px rgba(255,255,255,.12)}
  #orbit{position:absolute;inset:0;transform-origin:50% 50%;z-index:2;pointer-events:none}
  #orbit .carrier{position:absolute;left:50%;top:50%}
  #moon{position:absolute;left:0;top:0;transform:translate(200px,-50%);width:110px;height:110px;border-radius:50%;cursor:pointer;pointer-events:auto;background:center/cover no-repeat url("./images/ge-radio-logo.png");box-shadow:0 0 10px 3px rgba(140,200,255,.35)}
  /* mini player button */
  .sunOverlay{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;pointer-events:none}
  .about{margin-top:10%;font-weight:900;letter-spacing:.22em;font-size:13px;text-shadow:0 0 14px rgba(150,190,255,.45)}
  #musicBtn{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);pointer-events:auto;background:rgba(12,24,40,.65);border:1px solid rgba(200,220,255,.35);padding:6px 10px;border-radius:999px}
  /* popover */
  #playerBox{position:fixed;left:12px;bottom:12px;z-index:8;display:none;background:rgba(10,20,35,.9);border:1px solid rgba(200,220,255,.35);border-radius:14px;padding:10px;backdrop-filter:blur(4px);min-width:260px}
  #playerBox.show{display:block}
  #title{font-weight:700;margin:4px 0 8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .row{display:flex;gap:8px;align-items:center;margin:6px 0}
  .btn{width:30px;height:30px;border-radius:8px;border:1px solid rgba(200,220,255,.35);display:grid;place-items:center;cursor:pointer}
  .toggle{border:1px solid rgba(200,220,255,.35);padding:4px 8px;border-radius:999px;cursor:pointer}
  .active{background:rgba(60,140,255,.45)}
  /* hidden text words */
  .phrase{position:absolute;color:#cfe9ff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.9);opacity:0;transition:opacity .5s}
  .phrase.show{opacity:1}
  @media (max-width: 768px){
    #sunWrap{width:180px;height:180px;left:22vw;top:66vh}
    #moon{width:82px;height:82px;transform:translate(150px,-50%)}
  }
</style>
</head>
<body>
<canvas id="fx"></canvas>
<div id="phrases"></div>
<div id="planets"></div>

<div id="sunWrap">
  <div id="sun">
    <div class="sunOverlay">
      <div class="about">ABOUT</div>
      <button id="musicBtn">Music Controls</button>
    </div>
  </div>
  <div id="orbit"><div class="carrier"><div id="moon" title="Grand Element Radio"></div></div></div>
</div>

<!-- player popover -->
<div id="playerBox">
  <div id="title">—</div>
  <div class="row">
    <div class="btn" id="prev">◀</div>
    <div class="btn" id="play">▶</div>
    <div class="btn" id="next">▶▶</div>
  </div>
  <div class="row">
    <div class="toggle active" id="tgShuffle">Shuffle</div>
    <div class="toggle" id="tgAlbum">Album</div>
  </div>
  <audio id="gePlayer" preload="auto" playsinline></audio>
</div>

<!-- HUD -->
<div id="hud">
  <div><b>Boot</b></div>
  <div id="status" class="small">Starting…</div><hr>
  <div><b>Modules</b></div>
  <ul id="mods" class="small"></ul><hr>
  <div><b>Errors</b></div>
  <pre id="errs" class="small" style="max-width:44vw;max-height:28vh;overflow:auto;white-space:pre-wrap"></pre>
</div>

<script type="module">
  const HUD = {
    mods: document.getElementById('mods'),
    errs: document.getElementById('errs'),
    status: document.getElementById('status'),
    mod(name, ok, msg=''){ const li=document.createElement('li'); li.innerHTML=`${ok?'<span class="ok">✓</span>':'<span class="fail">✗</span>'} ${name} ${msg?'<span class="muted">— '+msg+'</span>':''}`; this.mods.appendChild(li); },
    err(e){ this.errs.textContent += (e?.stack||e)+'\n\n'; }
  };
  addEventListener('error', e=>HUD.err(e.error||e.message));
  addEventListener('unhandledrejection', e=>HUD.err(e.reason||e));

  // UPDATE THESE THREE ONLY
  const ROOT_IMG  = 'https://grandelement.github.io/website/images/';
  const ROOT_DATA = 'https://grandelement.github.io/website/data/';
  const ROOT_MUS  = 'https://grandelement.github.io/radio/music/';

  HUD.status.textContent = 'Loading modules…';
  try{
    const mCore    = await import('./js/core.js').then(m=>{m.init({HUD,ROOT_IMG,ROOT_DATA,ROOT_MUS}); HUD.mod('core', true); return m;}).catch(e=>{HUD.mod('core',false); throw e;});
    await import('./js/planets.js').then(m=>{m.init({HUD,ROOT_IMG}); HUD.mod('planets',true);}).catch(e=>{HUD.mod('planets',false); throw e;});
    await import('./js/moon.js').then(m=>{m.init({HUD}); HUD.mod('radio moon',true);}).catch(e=>{HUD.mod('radio moon',false); throw e;});
    await import('./js/hidden-text.js').then(m=>{m.init({HUD,ROOT_DATA}); HUD.mod('hidden text',true);}).catch(e=>{HUD.mod('hidden text',false); throw e;});
    await import('./js/player.js').then(m=>{m.init({HUD,ROOT_MUS}); HUD.mod('music player',true);}).catch(e=>{HUD.mod('music player',false); throw e;});
    await import('./js/fx.js').then(m=>{m.init({HUD,ROOT_IMG}); HUD.mod('comets/ships FX',true);}).catch(e=>{HUD.mod('comets/ships FX',false); throw e;});
    HUD.status.textContent = 'All modules loaded.';
  }catch(e){ HUD.status.textContent='Module load failed. See Errors.'; HUD.err(e); }
</script>
</body>
</html>
